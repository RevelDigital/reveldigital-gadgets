<?xml version="1.0" encoding="UTF-8" ?> 
<Module> 
<ModulePrefs title="RevelDigital Ads Gadget" description="Reads XML" author="RevelDigital" background="transparent">
  <UserPref name="spreadsheetUrl" display_name="Published spreadsheet URL" datatype="string" />
</ModulePrefs>
<Content type="html">
<![CDATA[
<style type="text/css">
@import url(https://fonts.googleapis.com/css?family=Montserrat:400,700);

body {
    font-family: Montserrat;
}

#parent {
    width: 100%;
    margin: 0px auto;
}

#container {
    width: 75%;
    margin: 0 auto;
	color: black;
}

#infoContainer {
	position: absolute;
	top: 10px;
	left: 10px;
	color: black;
}

</style>
<script src="https://code.jquery.com/jquery-2.2.3.min.js"   integrity="sha256-a23g1Nt4dtEYOj7bR+vTu7+T8VP13humZFBJNIYoEJo="   crossorigin="anonymous"></script>
<script src="https://reveldigital.github.io/reveldigital-gadgets/third-party/tabletop.js" type="text/javascript"></script>

<script type="text/javascript">
	setInfo('Working');
	var prefs = new gadgets.Prefs();
	gadgets.util.registerOnLoadHandler(initialize);
 
	function initialize() {		
		setInfo('Initialising');
		var link = "http://scontent.lrcdn.net/outbound-cdn-static/js/LiveRail.AdManager-1.0.js?LR_PUBLISHER_ID=144578&LR_WATERFALL=1&LR_WRAPPER_LIMIT=5&LR_URL=%24%24REFERER_ESC%24%24&LR_SUBSEQUENT_VAST2_VPAID_CALL";
		setInfo('Initial url ' + link);
		// var res = encodeURIComponent(url);
		setInfo('Encoded url ' + link);
		makeRequest(link);
	 }
  
	
	function makeRequest(url) {
		setInfo('Making proxied request');
		$.ajax({
			url: "https://as1.reveldigital.com/proxy?url=" + url,
			type: 'GET',
			dataType: 'text',
			success: function(res) {
				setContent(res);
			},
			error: function(data) {
				setInfo('Error is ' + data);
			}
		});
	}
	
	
	 
	function setContent(data) {
		var container = $('#container');
	
		var scrpt = "<script>";
		scrpt += data;
		scrpt += "<";
		scrpt += "/script>";

		var myIframe = document.getElementById("frame");
		var script = myIframe.contentWindow.document.createElement("script");
		script.type = "text/javascript";
		script.src = scrpt;
		myIframe.contentWindow.document.body.appendChild(script);
	}
	
	function setInfo(data) {
		if (true) {
			var container = $('#infoContainer');
			container.append(data + '<br>');
		}	
		if (true) {
			console.log(data);
		}
		if (false) {
			alert(data);
		}
	}
	
</script>
<body>
<h3>flowplayer</h3>
	<a href="https://pubads.g.doubleclick.net/gampad/ads?sz=160x600|300x250|728x90&iu=/376053887/Ascendant_Merchant_Services&impl=s&gdfp_req=1&env=vp&output=vast&unviewed_position_start=1&url=[referrer_url]&description_url=[description_url]&correlator=[timestamp]"
	style="display:block;width:640px;height:360px" id="flowplayer">
		 <img src="http://adsnet4all.com/video/epom.jpg"/>
	</a>
	<script type="text/javascript"
	src="http://releases.flowplayer.org/js/flowplayer-3.2.9.min.js"></script>
	<script type="text/javascript">
     flowplayer("flowplayer",
		"http://player.longtailvideo.com/flowplayer/flowplayer-3.2.7.swf",
             {
                 plugins:{

					ova:{
						"ads":{
							"filterOnLinearAdMimeTypes":false,"pauseOnClickThrough":true,"replayNonLinearAds":false,"controls":{"skipAd":{"image":"http://adsnet4all.com/img/skip-ad.png","minimumAdDuration":10,"width":60,"showAfterSeconds":5,"showForSeconds":5,"enabled":false,"height":15},"visible":false},"notice":{"type":"countdown"},"servers":[{"apiAddress":"http://adsnet4all.com/vast.xml?key=7f7e0098076fe4e8686108f500b31b7d__amp__zone=__zone____amp__epomUrl=__page-url__","type":"direct"}],"schedule":[{"zone":"PRE_ROLL","position":"pre-roll","playOnce":true}]},"debug":{"debugger":"firebug","levels":"fatal,config, vast_template, vpaid,http_calls"},"overlays":{"closeButton":{"image":"http://adsnet4all.com/img/close-ad.png","width":15,"type":"custom","height":15}},"url":"http://player.longtailvideo.com/flowplayer/ova-trial.swf","delayAdRequestUntilPlay":true}
                 }
             }
     );
	</script>

<h3>jwplayer</h3>
<div id="jwplayer">JW Player</div>
<script type="text/javascript"
src="http://www.eib-dz.com/public/js/jwplayer/jwplayer.js"></script>
<script type="text/javascript">
     jwplayer("jwplayer").setup({
         flashplayer:"https://ia601703.us.archive.org/8/items/JwPlayerFiles/player.swf",
         file:"http://adsnet4all.com/video/epom.mp4",
         image:"http://adsnet4all.com/video/epom.jpg",
         plugins:'ova-trial',

config:'http://www.advertizingms.com/vast.xml?key=af29a2f2dc431d7895695f54c3877416&zone=PRE_ROLL',
         width:640,
         height:360
     });
</script>
</body>]]>
</Content>
</Module>
