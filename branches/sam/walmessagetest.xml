<?xml version="1.0" encoding="UTF-8" ?> 
<Module> 
<ModulePrefs title="RevelDigital Google Spreadsheet Gadget" description="Basic tabular display of Google spreadsheet data" author="RevelDigital" background="transparent">
  <UserPref name="apikey" display_name="API Key" datatype="string" required="true" />
</ModulePrefs>
<Content type="html">
<![CDATA[

<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.2.6/jquery.min.js" type="text/javascript" charset="utf-8"></script>

<style type="text/css">

#imageview {
    width: 350px;
    height: 700px;
}

</style>


<script type="text/javascript" charset="utf-8">





$(function() {
    waitForMsg(); 
});


function showImage(image) {
	image = image.split(' ').join('%20')
	//$("#imageview").empty();
	$("#imageview").html("<img width='380' height='690' src =" + image + ">");
}



function waitForMsg(){

    $.ajax({
        type: "GET",
        url: "http://www.lumisnet.com/msgsrv.php",
        crossDomain: true,
        async: true,
        cache: false,
        timeout:50000, 
        success: function(data){ 
            showImage(data)
            setTimeout(
                waitForMsg, 
                5000 
            );
        },
        error: function(XMLHttpRequest, textStatus, errorThrown){
            setTimeout(
                waitForMsg,
                5000); 
        }
    });
};





function getMedia() {

    var image = $.getJSON("http://api.reveldigital.com/playlists.json?api_key=OpcmytWN8Nc", function (data) {
      
      for(var i=0; i < data.length; i++) {
        var currentPlaylist = data[i];
        if(currentPlaylist.name.toLowerCase() == 'movie titles 2') {
        	console.log(currentPlaylist.sources.length);

        	for(var j=0; j<currentPlaylist.sources.length; j++) {
        		var tempImage = new Image();
        		tempImage.src = currentPlaylist.sources[j].media.file_url;
        		items.push(tempImage);
        		console.log(currentPlaylist.sources[j].media.file_url);	
        	}

        }
      }

    });
}


</script>







<body>
    <div id="imageview">

    </div>
</body>



]]>
</Content>
</Module>