<?xml version="1.0" encoding="UTF-8"?>
<Module>
<ModulePrefs title="Christmas Countdown" background="transparent" author="RevelDigital" description="Countdown days until Christmas">
<UserPref required="true" datatype="hidden" display_name="width" name="rdW"/>
<UserPref required="true" datatype="hidden" display_name="height" name="rdH"/>
<UserPref required="true" default_value="font-family:'Mountains of Christmas',cursive;color:#ffffff;font-size:65px;" datatype="style" display_name="Message Style" name="message-style"/>
<UserPref datatype="hidden" name="ForeColor"/>
<UserPref datatype="hidden" name="BackColor" default_value="FFFFFF" />
</ModulePrefs>
<Content type="html">
<![CDATA[

            <style type="text/css">

                body *
                {
                    line-height: 1.2em; 
                    letter-spacing: 0; 
                    word-spacing: normal;
                }

                body
                {
                    width: __UP_rdW__px;
                    height: __UP_rdH__px;
                    overflow: hidden;
                    padding: 0;
                    margin: 0;
                    text-align: center;
                    background: #88d0ee; /* For browsers that do not support gradients */
                    background: radial-gradient(#88d0ee, #528ec3); /* Standard syntax */
                    background-size: cover; 
                    background-position: center;
                    background-image: url("https://reveldigital.github.io/reveldigital-gadgets/images/xmas-countdown-background.jpg");
                }

                a 
                {
                    color: white;
                    font-weight: bold;
                    text-decoration: none;
                }

                .content 
                {
                    
                    display: block;
                }

                .content .text
                {
                    text-align: left;
                    line-height: 1.5;
                    width: 90%;
                    max-width: 650px;
                    margin: 0 auto;
                    margin-bottom: 10px;
                }

                #countdownHTML 
                {
                    __UP_message-style__;
                    font-size: calc(4vw + 4vh);
                    color: #fff;
                    margin-top: 5vh;
                    cursor: default;
                    text-shadow: 0px 8px 15px rgba(0, 0, 0, 0.3);
                }
                #particles-js {
                    position: absolute;
                    width: 100%;
                    height: 100%;
                    background: linear-gradient(to bottom, rgba(117, 114, 113, 0.8) 10%, rgba(40, 49, 77, 0.8) 30%, rgba(29, 35, 71, 0.8) 50%, rgba(19, 25, 28, 0.8) 80%, rgba(15, 14, 14, .8) 100%));
                    background-repeat: no-repeat;
                    background-size: cover;
                    background-position: 50% 50%;
                }
                                
            </style>

            <script src="https://cdn.jsdelivr.net/particles.js/2.0.0/particles.min.js"></script>
            <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>
            <script src="https://reveldigital.github.io/gadget-common/utils.js" type="text/javascript"></script>
            <script src="https://ajax.googleapis.com/ajax/libs/webfont/1.6.26/webfont.js"></script>

            <div class="frame">
            <div id="particles-js"></div>
                <div class="content">
                    <div id="countdownHTML">
                    </div>
                </div>
            </div>

            <script type="text/javascript">

                var prefs = new gadgets.Prefs();

                WebFont.load({
                    google: {
                    families: [
                        RevelDigital.getFamilyName(prefs.getString("message-style"))
                    ]
                    }
                });
                particlesJS("particles-js", {
                    "particles": {
                        "number": {
                        "value": 400,
                        "density": {
                            "enable": true,
                            "value_area": 800
                        }
                        },
                        "color": {
                        "value": "#ffffff"
                        },
                        "shape": {
                        "type": "image",
                        "stroke": {
                            "width": 3,
                            "color": "#fff"
                        },
                        "polygon": {
                            "nb_sides": 5
                        },
                        "image": {
                            "src": "http://www.dynamicdigital.us/wp-content/uploads/2013/02/starburst_white_300_drop_2.png",
                            "width": 100,
                            "height": 100
                        }
                        },
                        "opacity": {
                        "value": 0.7,
                        "random": false,
                        "anim": {
                            "enable": false,
                            "speed": 1,
                            "opacity_min": 0.1,
                            "sync": false
                        }
                        },
                        "size": {
                        "value": 5,
                        "random": true,
                        "anim": {
                            "enable": false,
                            "speed": 20,
                            "size_min": 0.1,
                            "sync": false
                        }
                        },
                        "line_linked": {
                        "enable": false,
                        "distance": 50,
                        "color": "#ffffff",
                        "opacity": 0.6,
                        "width": 1
                        },
                        "move": {
                        "enable": true,
                        "speed": 5,
                        "direction": "bottom",
                        "random": true,
                        "straight": false,
                        "out_mode": "out",
                        "bounce": false,
                        "attract": {
                            "enable": true,
                            "rotateX": 300,
                            "rotateY": 1200
                        }
                        }
                    },
                    "interactivity": {
                        "detect_on": "canvas",
                        "events": {
                        "onhover": {
                            "enable": true,
                            "mode":  "bubble"
                        },
                        "onclick": {
                            "enable": true,
                            "mode": "repulse"
                        },
                        "resize": true
                        },
                        "modes": {
                        "grab": {
                            "distance": 150,
                            "line_linked": {
                            "opacity": 1
                            }
                        },
                        "bubble": {
                            "distance": 200,
                            "size": 40,
                            "duration": 2,
                            "opacity": 8,
                            "speed": 3
                        },
                        "repulse": {
                            "distance": 200,
                            "duration": 0.2
                        },
                        "push": {
                            "particles_nb": 4
                        },
                        "remove": {
                            "particles_nb": 2
                        }
                        }
                    },
                    "retina_detect": true
                });

                var targetDate = new Date("12/25/"+ new Date().getFullYear());
                var sec = true;
                var string;
                var secondsNumber;
                var minutesNumber;
                var hoursNumber;
                var daysNumber;
                var seconds;
                var minutes;
                var hours;
                var days;

                function calculate()
                {
                    var rawCountdownNumber = targetDate.getTime() - new Date().getTime();
                    
                    if (rawCountdownNumber <= 1000){
                        rawCountdownNumber = 0;
                        document.getElementById("countdownHTML").innerHTML = "Merry Christmas!";
                        return;
                    }

                    secondsNumber = (rawCountdownNumber / 1000) >> 0;
                    minutesNumber = (secondsNumber / 60) >> 0;
                    hoursNumber = (minutesNumber / 60) >> 0;
                    daysNumber = (hoursNumber / 24) >> 0;
                    secondsNumber = secondsNumber % 60;
                    minutesNumber = minutesNumber % 60;
                    hoursNumber = hoursNumber % 24;
                    seconds = ", " + secondsNumber + " sec<br>";
                    minutes = minutesNumber + " min";
                    hours = hoursNumber + " hours,<br>";
                    days = daysNumber + " days, ";
                    

                    if(hoursNumber == 1){
                        hours = hoursNumber + " hour,<br>";
                    }

                    if(daysNumber == 1){
                        days = daysNumber + " day, ";
                    }

                    if(sec == true){
                        string = days + hours + minutes + seconds;
                    }else{
                        string = days + hours + minutes;
                    }
                    
                    document.getElementById("countdownHTML").innerHTML = string + "Till Christmas";

                }
                
                function load() {
                    calculate();
                    setInterval(calculate, 1000);
                }
                
                gadgets.util.registerOnLoadHandler(load);

            </script>
            
            <script type="text/javascript">
                
                if('serviceWorker' in navigator) {
                  navigator.serviceWorker.register('service-worker')
                    .then(function(registration) {
                      console.log('Service Worker Registered');
                    });
                }
                
            </script>
        ]]>
</Content>
</Module>